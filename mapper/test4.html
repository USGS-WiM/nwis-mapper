<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>
		<title>Waterservices IE11 Test</title>
		<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>	

		<script type="text/javascript">
		$( document ).ready(function() {
		
			$.support.cors = true;
		
			$("#clickMe").click(function() {
				getSites();
			});

			function getSites() {
				$("#loading").show();
				var url = "./nwis/site/?bBox=-110.255%2C37.84%2C-104.811%2C39.576&format=mapper%2C1.0&siteStatus=active&siteType=ES%2CGL%2CLK%2COC%2CST%2CWE&hasDataTypeCd=all";

				$.ajax({
					type: "GET",
					url: url,
					dataType: "xml",
					crossDomain: true,
					success: function(xml){
					
						document.getElementById("status").innerHTML = 'sites loaded successfully';
					
						$(xml).find('site').each(function(){
							var site_no = $(this).attr('sno');		
							$("#siteList").append("<li>" + site_no + "</li>");
						});
					},
					error: function(jqXHR, textStatus, errorThrown) {
						//$("#status").innerHTML = jqXHR.responseText;
						console.log(jqXHR, textStatus, errorThrown);
					},
					complete: function() {
						$("#loading").hide();
					}
				});
			}
		});
	</script>
	</head>
	<body>
		<h3>Waterservices IE11 test</h3>
		<input id="clickMe" type="button" value="Get Sites"/>
		<span id="loading" style="display:none;">loading...</span>
		<p id="status"></p>
		<ul id="siteList"></ul>
	</body>
</html>
